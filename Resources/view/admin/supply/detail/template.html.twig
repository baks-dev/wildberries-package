{% trans_default_domain("wildberries-package.supply") %}

{% set ROLE = 'ROLE_MANUFACTURE_PART' %}

{# ---- ШАБЛОН ------------------------------------------------------------ #}
{% extends Template('/admin/base.html.twig') %}

{# ---- CSS ------------------------------------------------------------ #}
{% block title %}
    {{ 'page.index'|trans }}
{% endblock %}

{# ---- CSS ------------------------------------------------------------ #}
{% block stylesheets %}
    <link href="/assets/{{ version }}/plugins/nice-select2/nice-select2.min.css" rel="stylesheet" type="text/css">
    <link href="/assets/{{ version }}/css/print.min.css" rel="stylesheet" type="text/css">
{% endblock %}

{# ---- HEADER-БЛОК ------------------------------------------------------------ #}
{# {% block header %}
    {{ include(_self|replace({ "template.html.twig": "header.html.twig" })) }}
{% endblock %} #}


{# ---- LEFT-БЛОК ------------------------------------------------------------ #}
{# {% block left %} #}
{#   {% include '@Template/flowers/left.html.twig' %} #}
{# {% endblock %} #}


{# ---- КОНТЕНТ-БЛОК ------------------------------------------------------------ #}
{% block content %}
    {{ include(_self|replace({ "template.html.twig": baks_settings.device~"/content.html.twig" })) }}

{% endblock %}


{# ---- FOOTER-БЛОК ------------------------------------------------------------ #}
{#
{% block footer %}
    {{ include(_self|replace({ "template.html.twig": "footer.html.twig" })) }}
{% endblock %}
#}

{% block javascript %}
<script nonce='{{ csp_nonce() }}' async  data-src='/assets/{{ version }}/plugins/nice-select2/nice-select2.min.js?v={{ version }}' class='lazy'></script>
<script nonce='{{ csp_nonce() }}' async  data-src="/assets/{{ version }}/js/print.min.js?v={{ version }}" class="lazy"></script>
<script nonce='{{ csp_nonce() }}' async  data-src="/assets/{{ version }}/js/copy.min.js?v={{ version }}" class="lazy"></script>
<script nonce='{{ csp_nonce() }}' async data-src="/assets/{{ version }}/products-product/filter.min.js?v={{ version }}" class="lazy"></script>

{#
<script nonce="{{ csp_nonce() }}">
document.addEventListener("DOMContentLoaded", (event) => {
	const form = document.forms.wb_orders_product_filter_form;
    form.addEventListener('change', () => { setTimeout(() => { form.submit(); }, 300); });
});
</script>
#}


<script nonce="{{ csp_nonce() }}">
    /** Обработчик выбора "Печать выполнена" */
    document.addEventListener("DOMContentLoaded", (event) => {
        const supplyOrdersFilterForm = document.forms.supply_orders_filter_form;
        supplyOrdersFilterForm.addEventListener("change", () => { setTimeout(() => { supplyOrdersFilterForm.submit(); }, 300); });
    });
</script>
<script nonce="{{ csp_nonce() }}">

/** Обработчики кнопок выбора заказов */
let select_all_to_print = document.querySelector("#select-all-to-print");
let add_all_to_print = document.querySelector("#add-all-to-print");


/** Выбор из списка  */
select_all_to_print?.addEventListener("click", function() {

	/* Выбрать все */
	select_all_to_print.classList.toggle("selected");

	if(select_all_to_print.classList.contains("selected"))
	{
		select_all_to_print.innerText = "Снять выбор";
		select_all_to_print.classList.remove("btn-outline-primary");
		select_all_to_print.classList.add("btn-primary");
	}
	else
   {
	   select_all_to_print.innerText = "Выбрать все";
	   select_all_to_print.classList.add("btn-outline-primary");
	   select_all_to_print.classList.remove("btn-primary");
   }


    // TODO
    const orders = document.querySelectorAll(".add-all-to-print");

    /* Выбрать все НЕ disabled */
    orders.forEach(checkbox => {if (!checkbox.disabled) { checkbox.checked = select_all_to_print.classList.contains("selected");} } );

    const checkboxes = document.querySelectorAll(".add-all-to-print");
    const atLeastOneChecked = Array.from(checkboxes).some(cb => cb.checked);

    if (atLeastOneChecked) {
        add_all_to_print.classList.remove("d-none");
    }
    else {
        add_all_to_print.classList.add("d-none");
    }
});

var checkboxs_all_to_print = document.querySelectorAll(".add-all-to-print");

/** Скрыть или показать кнопку "Добавить выбранные" */
for (checkbox_all_to_print of checkboxs_all_to_print) {

    checkbox_all_to_print?.addEventListener("click", function() {

        const checkboxes = document.querySelectorAll(".add-all-to-print");
        const atLeastOneChecked = Array.from(checkboxes).some(cb => cb.checked);

        if (atLeastOneChecked) {
           add_all_to_print.classList.remove("d-none");
        }
        else {
            add_all_to_print.classList.add("d-none");
        }

    });
}

</script>

{% endblock %}